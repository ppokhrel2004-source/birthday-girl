<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Birthday Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: "Quicksand", sans-serif;
      background: #000;
      color: white;
      overflow: hidden;
    }
    #game {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
    }
    #background {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
      opacity: 0;
      transition: opacity 1.5s ease-in-out;
    }
    #story {
      background: rgba(0, 0, 0, 0.6);
      padding: 16px;
      border-radius: 16px;
      margin-bottom: 20px;
      max-width: 95%;
      width: 95%;
      max-height: 50vh;
      font-size: 1.1em;
      opacity: 0;
      transition: opacity 1s ease-in-out;
      white-space: pre-line;
      overflow-y: auto;
      box-sizing: border-box;
    }
    .dialogue {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin: 12px 0;
    }
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid white;
      flex-shrink: 0;
    }
    .bubble {
      display: inline-block;
      padding: 10px 16px;
      border-radius: 16px;
      max-width: 80%;
      word-wrap: break-word;
    }
    .you .bubble { background: #ffb6c1; color: black; }
    .friend .bubble { background: #add8e6; color: black; }
    .me .bubble { background: #98fb98; color: black; }
    .narrator .bubble { background: #eee; color: black; font-style: italic; }

    .choice {
      display: inline-block;
      margin: 8px;
      padding: 14px 24px;
      border: none;
      border-radius: 12px;
      background: #ffb6c1;
      color: black;
      font-size: 1em;
      cursor: pointer;
      transition: 0.3s;
      min-width: 48%;
      box-sizing: border-box;
    }
    .choice:hover { background: hotpink; color: white; }

    audio { display: none; }

    @media (max-width: 600px) {
      #story { font-size: 1em; max-height: 55vh; }
      .avatar { width: 35px; height: 35px; }
      .bubble { padding: 8px 12px; }
      .choice { padding: 12px 20px; font-size: 0.95em; }
    }
  </style>
</head>
<body>
  <div id="game">
    <img id="background" src="images/start.jpg" alt="Background">
    <div id="story">Loading...</div>
    <div id="choices"></div>
  </div>

  <audio id="bg-music" loop>
    <source src="music/birthday.mp3" type="audio/mpeg">
  </audio>

  <script>
    // Scenes data remains same as before with avatars
    const scenes = {
      start: { dialogue:[{text:"Happy Birthday!!!", avatar:"avatars/friend1.jpg", role:"friend"}, {text:"Aww thank you!", avatar:"avatars/you.jpg", role:"you"}, {text:"Nayana hugs you tight. Soon, Shruti, MJ, Aleena call too. Your parents call right after. After all the love, now you need your beauty sleep.", avatar:"avatars/narrator.jpg", role:"narrator"}], image:"images/midnight.jpg", options:[{text:"Continue", next:"morning"}]},
      morning: { dialogue:[{text:"The next morning‚Ä¶", avatar:"avatars/narrator.jpg", role:"narrator"}, {text:"MontFort is closed today to celebrate your birthday. Just as you‚Äôre about to go back to sleep, your phone rings from an unknown number...", avatar:"avatars/narrator.jpg", role:"narrator"}], image:"images/morning.jpg", options:[{text:"Pick up the call üìû", next:"call_picked"}, {text:"Decline ‚ùå", next:"call_declined"}]},
      call_picked: { dialogue:[{text:"Hello?", avatar:"avatars/you.jpg", role:"you"}, {text:"We have a flower delivery for you downstairs.", avatar:"avatars/friend2.jpg", role:"friend"}, {text:"Excited, you rush down‚Ä¶ and there he is, standing with flowers just for you.", avatar:"avatars/narrator.jpg", role:"narrator"}], image:"images/flowers.jpg", options:[{text:"Continue", next:"together"}]},
      call_declined: { dialogue:[{text:"Nah, must be spam‚Ä¶", avatar:"avatars/you.jpg", role:"you"}, {text:"Nope! Come downstairs right now. This is important!", avatar:"avatars/friend1.jpg", role:"friend"}, {text:"She drags you down‚Ä¶ and there he is, standing with flowers, just for you.", avatar:"avatars/narrator.jpg", role:"narrator"}], image:"images/flowers.jpg", options:[{text:"Continue", next:"together"}]},
      together: { dialogue:[{text:"Happy Birthday, my sweetheart", avatar:"avatars/me.jpg", role:"me"}, {text:"Babyyyyyy", avatar:"avatars/you.jpg", role:"you"}, {text:"Now‚Ä¶ how shall we spend the day?", avatar:"avatars/me.jpg", role:"me"}], image:"images/decision.jpg", options:[{text:"Stay in the hotel room", next:"hotel"}, {text:"Explore the city", next:"city"}]},
      hotel: { dialogue:[{text:"It's a cozy room, with cream walls and a fluffy bed. You can‚Äôt wait to snuggle inside.", avatar:"avatars/narrator.jpg", role:"narrator"}, {text:"What do you wanna do, my love?", avatar:"avatars/me.jpg", role:"me"}, {text:"Can we watch a movie?", avatar:"avatars/you.jpg", role:"you"}, {text:"Of course babyyy, I‚Äôll put it on! Hasee toh Phasee for you my favourite boy.", avatar:"avatars/me.jpg", role:"me"}, {text:"This movie is my favorite :>", avatar:"avatars/you.jpg", role:"you"}, {text:"And the pizza and pasta make it even better!", avatar:"avatars/me.jpg", role:"me"}, {text:"The day feels like a warm dream, wrapped in love.", avatar:"avatars/narrator.jpg", role:"narrator"}], image:"images/hotel.jpg", options:[{text:"Continue", next:"ending_hotel"}]},
      city: { dialogue:[{text:"You decide to go exploring Bangalore together. First stop: a pottery class!", avatar:"avatars/narrator.jpg", role:"narrator"}, {text:"This sounds adorable babyy.", avatar:"avatars/you.jpg", role:"you"}, {text:"I will always drink tea out of this mug you made me.", avatar:"avatars/me.jpg", role:"me"}, {text:"Later, you head to Baamey‚Äôs for momo, chowmein, and aloo dum. You've always wanted to go there, it's the perfect lunch date.", avatar:"avatars/narrator.jpg", role:"narrator"}], image:"images/city.jpg", options:[{text:"Continue ‚û°Ô∏è", next:"ending_city"}]},
      ending_hotel: { dialogue:[{text:"As night falls, you‚Äôre still curled up together, the movie softly playing.", avatar:"avatars/narrator.jpg", role:"narrator"}, {text:"Happy Birthday, my love. This was perfect. YOU are perfect.", avatar:"avatars/me.jpg", role:"me"}, {text:"I love you baby.", avatar:"avatars/you.jpg", role:"you"}], image:"images/hotel-night.jpg", options:[{text:"Restart üîÑ", next:"start"}]},
      ending_city: { dialogue:[{text:"You return to the hotel room, legs tired but hearts so full of love.", avatar:"avatars/narrator.jpg", role:"narrator"}, {text:"Happy Birthday, my love. I hope you enjoyed today.", avatar:"avatars/me.jpg", role:"me"}, {text:"Babyyy, I can‚Äôt believe you pulled this off!", avatar:"avatars/you.jpg", role:"you"}], image:"images/night.jpg", options:[{text:"Restart üîÑ", next:"start"}]}
    };

    const bg = document.getElementById("background");
    const storyBox = document.getElementById("story");
    const choicesDiv = document.getElementById("choices");
    const music = document.getElementById("bg-music");

    let currentScene = null;
    let currentDialogueIndex = 0;

    function renderNextDialogue() {
      const dialogue = currentScene.dialogue;
      if (currentDialogueIndex < dialogue.length) {
        const line = dialogue[currentDialogueIndex];
        const div = document.createElement("div");
        div.classList.add("dialogue", line.role);

        if (line.avatar) {
          const img = document.createElement("img");
          img.src = line.avatar;
          img.className = "avatar";
          div.appendChild(img);
        }

        const bubble = document.createElement("div");
        bubble.classList.add("bubble");
        bubble.innerText = line.text;
        div.appendChild(bubble);

        storyBox.appendChild(div);
        storyBox.scrollTop = storyBox.scrollHeight; // auto-scroll
        currentDialogueIndex++;
      } else {
        // show choices when dialogue is over
        choicesDiv.innerHTML = "";
        currentScene.options.forEach(option => {
          const btn = document.createElement("button");
          btn.innerText = option.text;
          btn.className = "choice";
          btn.onclick = () => showScene(option.next);
          choicesDiv.appendChild(btn);
        });
      }
    }

    function showScene(name) {
      currentScene = scenes[name];
      currentDialogueIndex = 0;
      storyBox.innerHTML = "";
      choicesDiv.innerHTML = "";
      bg.style.opacity = 0;

      setTimeout(() => {
        bg.src = currentScene.image;
        bg.style.opacity = 1;
        renderNextDialogue();
      }, 200);
    }

    // tap anywhere to advance
    document.body.addEventListener("click", () => {
      if (music.paused) music.play().catch(err => console.log("Music autoplay blocked:", err));
      renderNextDialogue();
    });

    showScene("start");
  </script>
</body>
</html>

